{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#quantitative-tools-for-assessing-the-correlated-evolution-of-genes-and-phenotypes-application-to-birds-color-patterns-q-t-birds","title":"Quantitative Tools for Assessing the Correlated Evolution of Genes and Phenotypes: Application to Birds Color Patterns (Q-T-Birds)","text":"<p>Welcome to the Q-T-Birds project archival website.  Q-T-Birds was an active postdoc project between 2022 \u2013 2024 by Viktor Senderov (I am going to use the first person pronoun on this website) based in H\u00e9l\u00e8ne Morlon\u2019s lab at the biology institute (IBENS) of the \u00c9cole normale sup\u00e9rieure, Paris, with collaborators from College de France.</p> <p>Its initial aim was to develop a comparative phylogenetics method for molecular evolution that could highlight genes that are potentially key to the formation of color patterns across bird species.  Here, you can download the project proposal, which is password-protected for confidentiality reasons<sup>1</sup>.</p> <p>During the course of the project we realized that the proposed modeling approach could accommodate any biological system, where we would like to link a molecular evolution process to a phenotypic evolution process, while incorporating phylogenetic information, and doing so in the context of a full gene, as opposed to on a site-by-site basis.  So we refer to the model as the QT Model.</p> <p>Furthermore, as a secondary objective, we set out to use the universal probabilistic programming language TreePPL, of which I am the main developer, to the Bayesian analysis.</p> <p>You can check out various research outputs of the project.</p> <p>As of 2024-09-26 the current status of the project is paused, as I am unemployed.  I am interested in an employment opportunity that would allow me to continue working on it or in transferring the project to a new leas. Contact me if you want to discuss either option.  </p> <ol> <li> <p>The password is the name-initial-year (without the period at the end) of the last citation on the second page in the References section of \u201cMolecular Evolution, A Statistical Approach\u201d, the 2014 edition.\u00a0\u21a9</p> </li> </ol>"},{"location":"QT%20Model/","title":"QT Model","text":"<p>The QT model is a model of simultaneous molecular and phenotypic evolution in which we are given three rates:</p> <ul> <li>\\(\\mu\\) \u2013 rate of molecular evolution, i.e. molecular substitution rate</li> <li>\\(\\lambda\\) \u2013 rate of phenotypic evolution, and</li> <li>\\(\\nu\\) \u2013 rate of simultaneous phenotypic and molecular evolution</li> </ul> <p></p> <p>For the molecular process one may select any known continuous-time substitution model, such as Jukes-Cantor, GTR, and so on.  We refer to Molecular Evolution: A Statistical Approach by Ziheng Yang for more details.  For the phenotypic process, the same statement holds, an example of a supported model is the Mk model.  Such models can be combined in a straightforward fashion by modifying the Q-matrix, by crossing the outcome space.  For example, if we had a molecular site that can be A, C, G, or T, and a phenotype that could be 0, or 1, the possible states are A0, C0, G0, T0, A1, C1, G1, and T1, and one can write an 8x8 Q-matrix incorporating the individual rates for all possible transitions. Apropos, this can be done trivially for two phenotypes as well.</p> <p>The challenge is if you want to model the evolution of a whole gene together with a phenotype.  All the possible nucleotide states of a gene are exponential with number of nucleotides (which is typically in the thousands), so it is impractical to write out the Q-matrix.  To overcome that our idea is to simplify the model somewhat by simulating (data augmenting) the number of simultaneous jumps of the gene and the phenotype, which we denote s-jumps. Roughly speaking, if an s-jump occurs, then both the gene and the phenotype jump in accordance to their own jump matrices, i.e. we do not model a different jump probability between different combinations of genotype and phenotype\u2014no matter what\u2019s the current phenotype and the current genotype, the jump rate is the same\u2014\\(\\nu\\).</p> <p>However, we have two sub-models for \\(\\nu\\).</p>"},{"location":"QT%20Model/#algorithm-1","title":"Algorithm 1","text":"<p>Here, an s-jump means that exactly one nucleotide jumps and the phenotype jumps.</p> <p></p> <p>The difficulty here is that you need to simulate for each site the number of s-jumps and then add them up.  We found out that this resulted in very intractable inference.</p> <p></p>"},{"location":"QT%20Model/#algorithm-2","title":"Algorithm 2","text":"<p>Here, we take a slightly more probabilistic approach to the interpretation of an s-jump.  Namely, we introduce an additional rate \\(p\\), which is the probability that, given an s-jump, and individual nucleotide will transition.  If \\(p=1/N\\), where \\(N\\) is the length of the gene, in expectation this algorithm becomes the first algorithm.</p> <ol> <li>Sample \\(n \\sim Poisson(\\nu t)\\).</li> <li>Then given the number of s-jumps on the edge, sites evolve independently and site i jumps a number \\(n_i \\sim Binomial(n, p)\\).</li> <li>Transition probability matrix for the sequence becomes \\(P_\\lambda(t)=((1-p)I + pJ)^n exp(\\lambda t Q_\\lambda)\\).</li> </ol> <p>This allows us to simulate only one number of s-jumps for each branch, and then integrate out the message likelihood (in Felsenstein\u2019s pruning algorithm) for each site.  (You may want to switch to dark mode from the toggle in the upper right, if you don\u2019t see the sketch below).</p> <p> TA...AAA...Alatent state</p> <p>We had computational difficulties with this approach as well.</p>"},{"location":"QT%20Model/#related-models","title":"Related models","text":"<p>Pelican is a related model, but it operates on a site-by-site basis.</p>"},{"location":"People/Collaborators/","title":"Collaborators","text":""},{"location":"People/Collaborators/#postdoc","title":"Postdoc","text":"<ul> <li>Viktor Senderov, Ecole normale sup\u00e9rieure, France</li> </ul>"},{"location":"People/Collaborators/#principle-investigators","title":"Principle investigators","text":"<ul> <li>H\u00e9l\u00e8ne Morlon, Ecole normale sup\u00e9rieure, France</li> <li>Amaury Lambert, \u00c9cole Normale Sup\u00e9rieure, France</li> <li>Marie Manceau, Coll\u00e8ge de France, France</li> </ul>"},{"location":"People/Collaborators/#intern","title":"Intern","text":"<ul> <li>Caitlyn Jean-Baptiste, Ecole normale sup\u00e9rieure, France (intern)</li> <li>Ingrid Lafontaine, Sorbonne Universit\u00e9, France (supervisor)</li> </ul>"},{"location":"People/Collaborators/#data-collection","title":"Data collection","text":"<ul> <li>Carole Desmarquet, Coll\u00e8ge de France, France</li> </ul>"},{"location":"People/Viktor%20Senderov/","title":"Viktor Senderov","text":""},{"location":"People/Viktor%20Senderov/#postdoctoral-researcher-2022-2024","title":"Postdoctoral researcher 2022 \u2013 2024","text":"<p>Previous postdocs, research positions, and PhD:</p> <ul> <li>Ronquist Lab (Bioinformatics) of the Swedish Museum of Natural History: Bayesian modeling of phylogenetics</li> <li>Broman Lab (Programming languages and compilers) at KTH Royal Institute of Technology: front-end compiler development</li> <li>Pensoft Publishers: biodiversity semantic publishing</li> </ul>"},{"location":"People/Viktor%20Senderov/#employment-opportunity","title":"Employment Opportunity","text":"<p>I am interested in permanent positions or permanent-track positions that will allow me to pursue data science research for the benefit of biology.  My primary scientific interests are intelligent databases (more recently knowledge-backed conversational agents) and modeling languages.  I have been a leader of two large academic software projects\u2014the OpenBiodiv semantic database and the TreePPL probabilistic programming language\u2014so I am open to applied and managerial positions, not only pure research.  Here, you can read a research statement from me and my CV as of the end 2023.</p>"},{"location":"People/Viktor%20Senderov/#contacts","title":"Contacts","text":"Personal website GitHub Account LinkedIn"},{"location":"Research%20Outputs/","title":"Research Outputs","text":""},{"location":"Research%20Outputs/#presentations-and-posters","title":"Presentations and Posters","text":"<p>On 23 \u2013 27 July 2023 the project was presented at the joint ISMB/ECCB<sup>1</sup> congress in Lyon, France with a poster and a presentation.  As a result of my presentation, I was invited to give a keynote at the University of Galway research days, which heavily featured the QT project.</p>"},{"location":"Research%20Outputs/#source-code-and-tooling","title":"Source code and tooling","text":"<p>The source code and tooling of QT project are still under development but several repositories exist.  If you want to use them, don\u2019t hesitate to contact me as the state of documentation is incomplete as of 2024-09-26.</p> <ul> <li>Implementation in WebPPL</li> <li>Python environment</li> <li>Implementation in TreePPL</li> </ul>"},{"location":"Research%20Outputs/#results","title":"Results","text":"<ul> <li>Results, experiments and project notes</li> </ul> <ol> <li> <p>Intelligent Systems For Molecular Biology/ European Conference On Computational Biology\u00a0\u21a9</p> </li> </ol>"},{"location":"Research%20Outputs/ISMB%20-%20ECCB%202023%20Poster/","title":"ISMB   ECCB 2023 Poster","text":"<p>Download our poster.</p> <p>Session C Poster Set-up and Dismantle Session C Posters set up: Wednesday, July 26,between 08:00 CEST and 08:45 CEST Session C Posters dismantle: Wednesday, July 26, at 19:00 CEST</p> <p>C-246: A Probabilistic Programming Approach to Investigate the Coevolution of Genes and Phenotypes in Birds</p> <p>Track:\u00a0EvolCompGen</p> <ul> <li>Viktor Senderov, Ecole normale sup\u00e9rieure, France</li> <li>Amaury Lambert, \u00c9cole Normale Sup\u00e9rieure, France</li> <li>Marie Manceau, Coll\u00e8ge de France, France</li> <li>Carole Desmarquet, Coll\u00e8ge de France, France</li> <li>Caitlyn Jean-Baptiste, Ecole normale sup\u00e9rieure, France</li> <li>Ingrid Lafontaine, Sorbonne Universit\u00e9, France</li> <li>H\u00e9l\u00e8ne Morlon, Ecole normale sup\u00e9rieure, France</li> </ul>"},{"location":"Research%20Outputs/ISMB%20-%20ECCB%202023%20Presentation/","title":"ISMB   ECCB 2023 Presentation","text":"<p>Download our presentation .</p>"},{"location":"Research%20Outputs/Implementation%20in%20TreePPL/","title":"Implementation in TreePPL","text":"<p>The QT model will be part of the official TreePPL release.</p> <p>However, until then use https://github.com/vsenderov/qtbirds.tppl.</p> <ul> <li><code>qt-1.tppl</code>: Inference for Algorithm 1</li> <li><code>qt-2.tppl</code>: Inference for Algorithm 2</li> <li><code>qtbirds.tppl</code>: (deprecated) older version of the inference, where I was experimenting with uniform priors</li> </ul>"},{"location":"Research%20Outputs/Implementation%20in%20WebPPL/","title":"Implementation in WebPPL","text":"<p>WebPPL is a probabilistic programming language for the web developed by Noah Goodman et al. that I used to prototyping the implementation of the QT model as a stable version of TreePPL was not available in 2022.  This prototype can be cloned from https://github.com/vsenderov/qtbirds.webppl.</p>"},{"location":"Research%20Outputs/Implementation%20in%20WebPPL/#simulation","title":"Simulation","text":"<p>Its main usefulness is simulating under Algorithm 1 (<code>qtbirds-sim.wppl</code>)\u2014well tested\u2014and Algorithm 2 (<code>qtbirds-sim2.wppl</code>)\u2014not so well tested.  You can simulate directly from the command like (see the comments at the top of the file for details):</p> <pre><code> *   webppl qtbirds-sim.wppl --require fasta2json \n *                           --require . \n *                           --require webppl-fs\n *                           --require phyjs -- ...\n</code></pre> <p>Or, you can invoke it from Python.</p>"},{"location":"Research%20Outputs/Implementation%20in%20WebPPL/#inference","title":"Inference","text":"<p>WebPPL can also do sequential Monte-Carlo (SMC) and Markov Chain Monte-Carlo inference, but it is not very performant for our model.  For this reason <code>qtbirds-inf*</code> are deprecated as of 2024-09-26.</p> <p>Version</p> <p>You should use version sp13.1.0 of qtbirds.webppl (see GitHub tags), as version 14 contains a wrong inference schema.  Either way, you should not use qtbirds.webppl for inference.</p>"},{"location":"Research%20Outputs/Python%20Environment/","title":"Python Environment","text":"<p>Title</p> <p>Under development</p> <p>Since Bayesian models are implemented in TreePPL and WebPPL, which are modeling languages, we need some higher-level code to do graphics, data formatting, batch processing, etc.  You can find this code under https://github.com/vsenderov/qtbirds.py.  There are two branches: <code>main</code> and <code>mcmc</code>.  The <code>mcmc</code> branch attempts to leverage the latest MCMC developments from TreePPL, but as they were not stable as of 2024-09-26, it is not yet merged and will probably be broken with future TreePPL releases.  Look at <code>examples</code> on how to use this.</p>"},{"location":"Research%20Outputs/Results%2C%20Experiments%20and%20Project%20Notes/","title":"Results, Experiments and Project Notes","text":"<p>The results of QT analysis are still to be published.  Here, I am summarizing the preliminary findings and giving some future directions.</p>"},{"location":"Research%20Outputs/Results%2C%20Experiments%20and%20Project%20Notes/#model-verification","title":"Model verification","text":"<p>We used simulation-based calibration to verify the correctness of our likelihood implementation vs the generative model:</p> <ul> <li>we simulate data with the simulators (short \u201cgenes\u201d 10\u2013100 nucleotides, small trees: &lt; 50 sp)</li> <li>we then infer using the inference in TreePPL</li> <li>we plot the true known values against their inferred credible intervals and expect to find that the credible intervals are well calibrated</li> </ul> <p>We found what we expected:</p>"},{"location":"Research%20Outputs/Results%2C%20Experiments%20and%20Project%20Notes/#biological-results","title":"Biological results","text":"<p>As the bird dataset was not available, we attempted to apply the model on an echolocation dataset from Pelican.  However, all three genes linked to echolocation had &gt; 2,000 nucleotides.  SMC inference resulted in out-of-memory errors, whereas MCMC inference did not converge in reasonable time.  We are currently improving the MCMC backend of TreePPL and it is possible that the new backend can handle the model.</p>"},{"location":"Research%20Outputs/Results%2C%20Experiments%20and%20Project%20Notes/#archive","title":"Archive","text":"<p>Out Python notebooks containing numerical exploration, as well as lab notes are available to download here.  However, those are unorganized and contain experimental explorative code.  Therefore, they are also password-protected<sup>1</sup>.</p> <ol> <li> <p><code>openssl enc -d -aes-256-cbc -pbkdf2 -in experiments.tar.bz2.enc -out experiments-decrypted.tar.bz2 -k PWD -iter 10000</code> \u21a9</p> </li> </ol>"}]}